# Туториал по расшифровке программы программатора Шахты 3

## 📋 Обзор

Документ описывает полный процесс декодирования бинарной программы формата v3 из Base64. Программа содержит цепочку операторов с метками, подвергается LZMA сжатию и представляется визуально в клиенте.

---

## 🔐 Исходные данные

**Base64 закодированная программа:**

```base64
HQAAgAAIAAAAAAAAAAAFADjkobuzFSSNTOK60BytPRuvcpEnjdjhMd/+KkQA
```

---

## 📌 Ключевые факты

| №   | Факт                    | Значение                     |
| --- | ----------------------- | ---------------------------- |
| 1   | **Тип длины сегмента**  | LITTLE_ENDIAN Int32          |
| 2   | **Макс. операторов**    | 2 147 483 647                |
| 3   | **Макс. размер данных** | ~11,184,810 блоков (~9.99Gb) |
| 4   | **Макс. ID оператора**  | 182                          |
| 5   | **Скрытые операторы**   | 63 (незадействованные)       |
| 6   | **Метка по умолчанию**  | "0" (может быть пустой)      |
| 7   | **Макс. длина метки**   | 3 символа                    |
| 8   | **Создатель документа** | Игрок Darkir15               |

---

## 🔄 Процесс декодирования

```text
┌────────────────────────────────────────────────────┐
│ Base64 строка (исходная программа)                 │
└─────────────────┬──────────────────────────────────┘
                  ▼
┌────────────────────────────────────────────────────┐
│ Декодирование Base64 → Байтовый массив             │
└─────────────────┬──────────────────────────────────┘
                  ▼
┌────────────────────────────────────────────────────┐
│ Чтение LITTLE_ENDIAN Int32 (длина сегмента)        │
└─────────────────┬──────────────────────────────────┘
                  ▼
┌────────────────────────────────────────────────────┐
│ Извлечение сегмента операторов (LZMA сжатие)       │
└─────────────────┬──────────────────────────────────┘
                  ▼
┌────────────────────────────────────────────────────┐
│ LZMA декомпрессия → Исходные операторы             │
└─────────────────┬──────────────────────────────────┘
                  ▼
┌────────────────────────────────────────────────────┐
│ Чтение сегмента меток (ASCII кодирование)          │
└─────────────────┬──────────────────────────────────┘
                  ▼
┌────────────────────────────────────────────────────┐
│ Разбор метак по разделителю ':' (двоеточие)        │
└─────────────────┬──────────────────────────────────┘
                  ▼
┌────────────────────────────────────────────────────┐
│ Финальная цепочка операторов в клиенте             │
└────────────────────────────────────────────────────┘
```

---

## 📊 Структурированные данные

### Таблица 1: Байтовый массив длин сегментов

| Индекс | Значение | Индекс | Значение | Индекс | Значение |
| ------ | -------- | ------ | -------- | ------ | -------- |
| 0      | **29**   | 15     | 5        | 30     | 61       |
| 1      | 0        | 16     | 0        | 31     | 175      |
| 2      | 0        | 17     | 50       | 32     | 66       |
| 3      | 128      | 18     | 100      | 33     | 175      |
| 4      | 0        | 19     | 161      | 34     | 114      |
| 5      | 8        | 20     | 187      | 35     | 145      |
| 6      | 0        | 21     | 179      | 36     | 39       |
| 7      | 0        | 22     | 36       | 37     | 37       |
| 8      | 0        | 23     | 141      | 38     | 37       |
| 9      | 0        | 24     | 79       | 39     | 97       |
| 10     | 0        | 25     | 66       | 40     | 49       |
| 11     | 0        | 26     | 186      | 41     | 223      |
| 12     | 0        | 27     | 208      | 42     | 254      |
| 13     | 0        | 28     | 28       | 43     | 21       |
| 14     | 0        | 29     | 173      | 44     | 68       |

**Примечание:** Первый элемент (29) — длина сегмента операторов в LITTLE_ENDIAN Int32 формате.

---

### Таблица 2: Сегмент операторов (LZMA сжатие)

**Размер:** 11 байт

| Индекс | 0   | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   | 9   | 10  |
| ------ | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Байт   | 11  | 0   | 0   | 0   | 14  | 135 | 43  | 139 | 157 | 43  | 139 |

После LZMA декомпрессии: `[14, 135, 43, 139, 157, 43, 139, 15, 24, 10, 16]`

---

### Таблица 3: Сегмент меток операторов (ASCII)

| Индекс | ASCII | Символ | Индекс | ASCII | Символ |
| ------ | ----- | ------ | ------ | ----- | ------ |
| 0      | 48    | 0      | 13     | 58    | :      |
| 1      | 58    | :      | 14     | 82    | R      |
| 2      | 48    | 0      | 15     | 71    | G      |
| 3      | 58    | :      | 16     | 84    | T      |
| 4      | 48    | 0      | 17     | 58    | :      |
| 5      | 58    | :      | 18     | 48    | 0      |
| 6      | 48    | 0      | 19     | 58    | :      |
| 7      | 58    | :      | 20     | 82    | R      |
| 8      | 48    | 0      | 21     | 71    | G      |
| 9      | 58    | :      | 22     | 84    | T      |
| 10     | 48    | 0      | 23     | 58    | :      |
| 11     | 58    | :      | 24     | 48    | 0      |
| 12     | 48    | 0      |        |       |        |

**Полная строка:** `0:0:0:0:0:0:RGT:0:0:RGT:0`

---

### Таблица 4: Разбор метак операторов

| Позиция | 0   | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   | 9   | 10  |
| ------- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Метка   | 0   | 0   | 0   | 0   | 0   | 0   | RGT | 0   | 0   | RGT | 0   |

**Интерпретация:** 11 операторов, где операторы #6 и #9 имеют тип "RGT" (Register/Get/Target), остальные — нулевые значения.

---

## 🎨 Финальный вид программы в клиенте

**Визуальная схема потока:**

```text
Вход: [P] Start
        ↓
      [Operator 0: 0]
        ↓
      [Operator 1: 0]
        ↓
      [Operator 2: 0]
        ↓
      [Operator 3: 0]
        ↓
      [Operator 4: 0]
        ↓
      [Operator 5: 0]
        ↓
      [Operator 6: RGT] ← Специальный тип
        ↓
      [Operator 7: 0]
        ↓
      [Operator 8: 0]
        ↓
      [Operator 9: RGT] ← Специальный тип
        ↓
      [Operator 10: 0]
        ↓
      [F] End/Filter
```

**Элементы:**

- **[P]** — начальный оператор (Program Entry Point)
- **[Operator X: Label]** — оператор с метой
- **[F]** — конечный оператор (Filter/Function)
- **RGT** — специальный тип оператора для работы с памятью/регистрами
- **0** — нейтральный оператор

**Соединения:**

- Синие линии соединяют операторы в последовательность
- Зелёные линии передают результаты между операторами
- Каждый оператор может принимать входные данные и выдавать выходные

---

## 🔧 Технические спецификации

| Параметр                        | Значение                      |
| ------------------------------- | ----------------------------- |
| Формат ввода                    | Base64                        |
| Кодирование длины               | LITTLE_ENDIAN Int32           |
| Алгоритм сжатия                 | LZMA                          |
| Кодировка символов              | ASCII                         |
| Разделитель меток               | `:` (двоеточие)               |
| Всего операторов (активных)     | 182                           |
| Скрытых операторов              | 63                            |
| Максимум длины метки            | 3 символа                     |
| Максимум операторов в программе | 2,147,483,647                 |
| Максимум объёма данных          | ~9.99 Gb (≈11,184,810 блоков) |

---

## ⚙️ Алгоритм реализации

### Пошаговое декодирование

1. Декодировать Base64 строку в байтовый массив
2. Прочитать первые 4 байта как LITTLE_ENDIAN Int32 → длина сегмента (29 байт)
3. Извлечь следующие 29 байт → сжатый сегмент операторов
4. Применить LZMA деcompression → получить исходные 11 байт операторов
5. Продолжить чтение остальных сегментов (аналогично)
6. Для последнего сегмента: прочитать ASCII коды меток `48:58:48:58...` (0:0:0:...:RGT:0:0:RGT:0)
7. Разбить метки по разделителю `:` → получить массив меток
8. Соединить операторы с метками в цепочку
9. Визуализировать в клиенте слева направо

---

## 📝 Особенности и примечания

- **Линейная структура:** Все операторы соединяются в одну цепочку без ветвлений или циклов
- **Метки по умолчанию:** Если метка не указана, используется "0"
- **Типы операторов:** Основной используемый тип — RGT (Register/Get/Target)
- **Масштабируемость:** Максимум 182 разных типа операторов, из них 63 скрытых
- **Интерфейс:** Программа визуализируется в виде горизонтальной цепочки с иконками операторов
- **Пользовательские метки:** Каждая метка может быть от 1 до 3 символов (0-999 возможные значения)

---

**Формат:** Туториал для расшифровки программ v3 программатора  
**Версия:** Финальная итерация
